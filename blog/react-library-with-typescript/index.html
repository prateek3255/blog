<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to build a React library using TypeScript</title><meta name="description" content="A step by step guide to setup a React Library from scratch using TypeScript, and publish it to NPM."><link rel="canonical" href="undefined/blog/react-library-with-typescript/"><link rel="apple-touch-icon" sizes="152x152" href="undefined/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="undefined/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="undefined/favicons/favicon-16x16.png"><link rel="manifest" href="undefined/favicons/site.webmanifest"><link rel="mask-icon" href="undefined/favicons/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="twitter:title" content="How to build a React library using TypeScript"><meta property="twitter:description" content="A step by step guide to setup a React Library from scratch using TypeScript, and publish it to NPM."><meta name="twitter:image" content="undefined/img/react-library-with-typescript.png"><meta name="twitter:card" content="summary_large_image"><meta property="og:title" content="How to build a React library using TypeScript"><meta property="og:description" content="A step by step guide to setup a React Library from scratch using TypeScript, and publish it to NPM."><meta property="og:image" content="undefined/img/react-library-with-typescript.png"><meta property="og:url" content="undefined/blog/react-library-with-typescript/"><meta property="og:type" content="article"><link rel="stylesheet" type="text/css" href="undefined/css/style.css"><link rel="stylesheet" type="text/css" href="undefined/css/prism-tomorrow.css"><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/brands.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/solid.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/fontawesome.min.js"></script><script>function trackTagClick(t){trackEvent("tag_clicked","tags",t)}function trackEvent(t,c,a){console.log("Event",{name:t,category:c,label:a})}</script><script async src="https://unpkg.com/smoothscroll-polyfill/dist/smoothscroll.min.js"></script><script async src="https://unpkg.com/smoothscroll-anchor-polyfill"></script><script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer="defer"></script></head><body><div class="w-full"><nav class="flex items-center justify-center lg:justify-between flex-wrap p-6 lg:px-0 container mx-auto" x-data="navbarData()" @keydown.escape="isOpen = false"><div class="flex items-center"><a href="/" aria-label="logo"><img src="/img/prateek-bitmoji.png" alt="Logo" height="80" width="63.2" class="h-20"></a></div><button x-on:click="handleToggle" type="button" class="ml-auto block lg:hidden px-2 text-primary-500 hover:text-primary-500 focus:outline-none focus:text-primary-500" :class="{ 'transition transform-180': isOpen }" aria-label="Menu"><svg class="h-6 w-6 fill-current" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path x-show="isOpen" fill-rule="evenodd" clip-rule="evenodd" d="M18.278 16.864a1 1 0 0 1-1.414 1.414l-4.829-4.828-4.828 4.828a1 1 0 0 1-1.414-1.414l4.828-4.829-4.828-4.828a1 1 0 0 1 1.414-1.414l4.829 4.828 4.828-4.828a1 1 0 1 1 1.414 1.414l-4.828 4.829 4.828 4.828z"/><path x-show="!isOpen" fill-rule="evenodd" d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/></svg></button><div class="w-full flex-grow lg:flex lg:items-center lg:w-auto text-center transition-all duration-700 ease-in-out opacity-0 lg:opacity-100" :class="{ 'max-h-80 opacity-100': isOpen, 'max-h-0 opacity-0': !isOpen }" x-show.transition="true"><ul class="pt-6 lg:pt-0 list-reset lg:flex justify-end flex-1 items-center"><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/">About</a></li><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog">Blog</a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://twitter.com/psuranas"><i class="fab fa-twitter"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://github.com/prateek3255"><i class="fab fa-github"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://stackoverflow.com/users/8252081/prateek-surana"><i class="fab fa-stack-overflow"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog/feed.xml"><i class="fas fa-rss"></i></a></li></ul></div></nav></div><script>function navbarData(){return{isOpen:!1,handleToggle(){this.isOpen=!this.isOpen,void 0!==window.annotationGroup&&(window.annotationGroup.hide(),setTimeout(()=>{window.annotationGroup.show()},800))}}}</script><div x-data="newsletter()" x-init="startTimer()"><div class="container max-w-3xl mt-6 px-6"><div class="pb-5 mb-5 border-b border-gray-100"><h1 class="font-bold text-5xl">How to build a React library using TypeScript</h1><p class="text-center text-base leading-6 font-medium text-gray-500">Last updated on <time>08 Jun 2021</time> by Prateek Surana &nbsp; • &nbsp;<span class="read-time"> - min read</span></p></div><article class="prose lg:prose-xl my-4 relative"><p>Code reusability and modular design are what have made React one of the best JavaScript frameworks out there. Also, thanks to NPM, publishing a new JavaScript module has never been easier. All you need to do is point the main JavaScript file in your <code>package.json</code> and run <code>npm publish</code>. Although, you need to take care of a few more things when it comes to publishing a TypeScript package, and that's what we'll discuss in this guide.</p><h2 class="relative"><a id="why-typescript" href="#why-typescript" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Why TypeScript?</a></h2><p><a href="https://www.typescriptlang.org/">TypeScript is a strict syntactical superset of JavaScript</a> and adds optional static typing to the language, giving you the ability to write code free from the JavaScript type errors.</p><p>You don't necessarily need to use TypeScript to create a React module, but adding TypeScript results in a much better DX in editors like VSCode, where users get <a href="https://code.visualstudio.com/docs/languages/typescript#_intellisense">better IntelliSense</a> via the type definitions.</p><p>Also if your library becomes popular you will need to add type-definitions sometime, and writing and maintaining those manually is error-prone and wastes a lot of time.</p><p>And I think this goes without saying that TypeScript makes your code more robust and less prone to errors.</p><h2>Let's Begin</h2><p>We'll be building a small library with a <code>create-react-app</code> demo to help you understand the basic boilerplate setup for building and publishing a TypeScript React library, with the following steps -</p><ol><li><a href="#initializing-a-project-and-adding-typescript">Initializing a project and adding TypeScript</a></li><li><a href="#setting-up-typescript-config">Setting up TypeScript config</a></li><li><a href="#compiling-typescript">Compiling TypeScript</a></li><li><a href="#adding-react">Adding React</a></li><li><a href="#setting-up-the-demo">Setting up the demo</a></li><li><a href="#getting-ready-for-publishing">Getting ready for Publishing</a></li></ol><h2 class="relative"><a id="initializing-a-project-and-adding-typescript" href="#initializing-a-project-and-adding-typescript" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Initializing a project and adding TypeScript</a></h2><blockquote><p>A small heads up that I'll be using <a href="https://yarnpkg.com/">yarn</a> as the package manager throughout this guide since it is <a href="https://www.cubui.com/blog/javascript/why-yarn-is-better-than-npm/">much better than npm.</a></p></blockquote><p>We'll start by going through the setup of a plain JavaScript module using <code>yarn init</code> in a fresh folder and answering the prompts accordingly</p><pre class="language-bash"><code class="language-bash">$ <span class="token function">yarn</span> init<br><span class="token function">yarn</span> init v1.22.4<br>question name <span class="token punctuation">(</span>typescript-react-test<span class="token punctuation">)</span>:<br>question version <span class="token punctuation">(</span><span class="token number">1.0</span>.0<span class="token punctuation">)</span>: <br>question description: Learning how to create React modules using TypeScript<span class="token operator">!</span><br>question entry point <span class="token punctuation">(</span>index.js<span class="token punctuation">)</span>: <br>question repository url: <br>question author: <br>question license <span class="token punctuation">(</span>MIT<span class="token punctuation">)</span>: <br>question private: <br>success Saved package.json</code></pre><p>Since we want to write code in TypeScript, we need to set up the build step that will transpile our TypeScript code to JavaScript.</p><p>Install TypeScript as a dev dependency by running:</p><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev typescript</code></pre><p>While you're at it, don't forget to set up git in your folder and regularly commit; if you’re a beginner to git, I would recommend going through this <a href="https://product.hubspot.com/blog/git-and-github-tutorial-for-beginners">git tutorial for beginners</a>.</p><h2 class="relative"><a id="setting-up-typescript-config" href="#setting-up-typescript-config" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Setting up TypeScript config</a></h2><p>To compile TypeScript and enforce/ignore certain rules, we will need to create a config file called <code>tsconfig.json</code> in the root directory. At the time of writing this tutorial, I'm using <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-0.html">TypeScript version 4.0.2</a>. So if something is not working for you, it might be because some keys might have been updated or deprecated. I would recommend you to consult the <a href="https://www.typescriptlang.org/docs/handbook/release-notes/overview.html">release notes</a> for that.</p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"lib/esm"</span><span class="token punctuation">,</span><br>    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"esnext"</span><span class="token punctuation">,</span><br>    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span><br>    <span class="token property">"lib"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"es6"</span><span class="token punctuation">,</span> <span class="token string">"dom"</span><span class="token punctuation">,</span> <span class="token string">"es2016"</span><span class="token punctuation">,</span> <span class="token string">"es2017"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>    <span class="token property">"jsx"</span><span class="token operator">:</span> <span class="token string">"react"</span><span class="token punctuation">,</span><br>    <span class="token property">"declaration"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"moduleResolution"</span><span class="token operator">:</span> <span class="token string">"node"</span><span class="token punctuation">,</span><br>    <span class="token property">"noUnusedLocals"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"noUnusedParameters"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"noImplicitReturns"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"noImplicitThis"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"noImplicitAny"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"strictNullChecks"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"suppressImplicitAnyIndexErrors"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>    <span class="token property">"allowSyntheticDefaultImports"</span><span class="token operator">:</span> <span class="token boolean">true</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span><br>  <span class="token property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"src"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>  <span class="token property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"node_modules"</span><span class="token punctuation">,</span> <span class="token string">"lib"</span><span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre><p>Some of the important parameters we are using here are -</p><ul><li><strong><a href="https://www.typescriptlang.org/tsconfig#outDir">outDir</a></strong> - Specifies the output build directory for our compiled code. Since this would create an ESM build, we would output it to a folder called <code>lib/esm</code>. I'll explain why we did this later in this post.</li><li><strong><a href="https://www.typescriptlang.org/tsconfig#module">module</a></strong> - Sets the module system that your code will be compiled to. TypeScript supports a <a href="https://www.typescriptlang.org/tsconfig#module">variety of module types</a>.</li><li><strong><a href="https://www.typescriptlang.org/tsconfig#target">target</a></strong> - The ECMAScript version target we want TypeScript to compile to.</li><li><strong><a href="https://www.typescriptlang.org/tsconfig#lib">lib</a></strong> - Specified the built-in JS libraries that you want to support.</li><li><strong><a href="https://www.typescriptlang.org/tsconfig#include">include</a> - F</strong>ilename patterns that the compiler should scan.</li><li><strong><a href="https://www.typescriptlang.org/tsconfig#exclude">exclude</a> -</strong> Filename patterns that the compiler should ignore.</li></ul><p>TypeScript offers <a href="https://www.typescriptlang.org/tsconfig">a lot of flags for type checking and compiling</a>.</p><p>It's time to test our setup now, create a file <code>src/index.ts</code> and add the following snippet to it -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hey </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, say hello to TypeScript.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Next, add the following build script to your <code>package.json</code> -</p><pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><br> <span class="token punctuation">}</span></code></pre><p>Now run <code>yarn build</code> inside your root folder, and you should see a folder called <code>lib/esm</code> with the following files -</p><ul><li><code>index.js</code> - The compiled output file.</li><li><code>index.d.ts</code> - The <a href="https://www.typescriptlang.org/docs/handbook/declaration-files/templates/module-d-ts.html">type definitions</a> for your code.</li></ul><h2 class="relative"><a id="compiling-typescript" href="#compiling-typescript" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Compiling TypeScript</a></h2><p>Although we completed the setup for TypeScript and added a build script in the last step, we're not quite ready yet. To be able to publish our package to NPM, you need to be aware of the different types of modules available in the JavaScript ecosystem -</p><ul><li><a href="https://nodejs.org/docs/latest/api/modules.html#modules_modules_commonjs_modules">CommonJS</a> - This module format is most commonly used with Node using the <code>require</code> function. Even though we are publishing a React module (which will be consumed by an application generally written in ESM format, then bundled and compiled by tools like webpack), we need to consider that it might also be used within a Server side rendering environment, which generally uses Node and hence might require a CJS counterpart of the library (ESM modules are supported in Node environment as of <a href="https://nodejs.org/dist./v10.22.0/docs/api/esm.html">v10 behind an experimental flag</a>).</li><li><a href="https://nodejs.org/api/esm.html#esm_modules_ecmascript_modules">ESM</a> - This is the modern module format that we normally use in our React applications in which modules are defined using a variety of import and export statements. The main benefit of shipping ES modules is that it <a href="https://bitsofco.de/what-is-tree-shaking/">makes your library tree-shakable</a>. This is supported by tools like Rollup and webpack 2+.</li><li><a href="https://riptutorial.com/javascript/example/16339/universal-module-definition">UMD</a> - This module format is not as popular these days. It is required when the user requires our module using a script tag.</li></ul><p>So for our package, we will add support for both ESM and CommonJS modules. Currently, if you open the <code>index.js</code> file in the <code>lib/esm</code> folder, you will find that it's using the ESM format because we specified the module type to <code>esnext</code> in the <code>tsconfig</code> compiler options. That's the reason why I asked you to send the output to the <code>lib/esm</code> folder when setting up TypeScript.</p><p>To create a CommonJS module, add the following script to the scripts key in your <code>package.json</code></p><pre class="language-json"><code class="language-json"><span class="token property">"build:cjs"</span><span class="token operator">:</span> <span class="token string">"tsc --module commonjs --outDir lib/cjs"</span><span class="token punctuation">,</span></code></pre><p>The above script would use the configuration that we defined in our <code>tsconfig</code> except with the module key being changed to <code>commonjs</code> and the output directory to <code>lib/cjs</code></p><p>Also, update the <code>build</code> script and add a <code>build:esm</code> script as well, making the final scripts looking like this -</p><pre class="language-json"><code class="language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"yarn build:esm &amp;&amp; yarn build:cjs"</span><span class="token punctuation">,</span><br>    <span class="token property">"build:esm"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><span class="token punctuation">,</span><br>    <span class="token property">"build:cjs"</span><span class="token operator">:</span> <span class="token string">"tsc --module commonjs --outDir lib/cjs"</span><br> <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>You would see two folders in your lib directory when you run <code>yarn build</code>, one for both ESM and CommonJS builds.</p><p>As one last step, we need to specify the entry points for different types of modules in <code>package.json</code>, so that module bundlers/tools can pick up the appropriate format for them.</p><pre class="language-json"><code class="language-json"><span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"./lib/cjs/index.js"</span><span class="token punctuation">,</span><br><span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./lib/esm/index.js"</span><span class="token punctuation">,</span><br><span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"./lib/esm/index.d.ts"</span><span class="token punctuation">,</span></code></pre><blockquote><p>If your library has some external dependencies or some other assets, I would recommend using module bundlers like <a href="https://hackernoon.com/building-and-publishing-a-module-with-typescript-and-rollup-js-faa778c85396">Rollup to compile your library</a>.</p></blockquote><h2 class="relative"><a id="adding-react" href="#adding-react" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Adding React</a></h2><p>We have the TypeScript setup up and running, now its time to add React.</p><p>Since <code>react</code> requires that we need to have a single copy of <code>react-dom</code> that is also used by the person installing it. We will be adding it as a <a href="https://flaviocopes.com/npm-peer-dependencies/"><code>peerDependency</code></a>. Add the following snippet to your <code>package.json</code>.</p><pre class="language-json"><code class="language-json"><span class="token property">"peerDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span><br>    <span class="token property">"react"</span><span class="token operator">:</span> <span class="token string">"^16.8.0"</span><span class="token punctuation">,</span><br>    <span class="token property">"react-dom"</span><span class="token operator">:</span> <span class="token string">"^16.8.0"</span><br> <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre><p>But we also need React in our module, so we need to add it as a dev dependency as well -</p><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev react-dom react @types/react-dom @types/react</code></pre><p>Now let's create our React component, which will be consumed by our library users, replace the code in <code>src/index.tsx</code> with this -</p><pre class="language-tsx"><code class="language-tsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> SayHello <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">JSX</span><span class="token punctuation">.</span><span class="token parameter">Element</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">Hey </span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token plain-text">, say hello to TypeScript.</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> SayHello<span class="token punctuation">;</span></code></pre><h2 class="relative"><a id="setting-up-the-demo" href="#setting-up-the-demo" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Setting up the demo</a></h2><p>First let's build our library so that it can be consumed. Run the build command that we created in the last step -</p><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> build</code></pre><p>To be able to use and test our library, we would need an example project. We will be using <a href="https://create-react-app.dev/docs/adding-typescript/"><code>create-react-app</code> with the TypeScript template</a> for creating an example app to test our library. Run the following in the root folder -</p><pre class="language-bash"><code class="language-bash"><span class="token function">yarn</span> create react-app example --template typescript</code></pre><p>The above command would create a new TypeScript React application in a folder called example.</p><p>Also since we would be using the <code>.gitignore</code> file in our root folder, so delete the git related files from the example folder.</p><pre class="language-bash"><code class="language-bash"><span class="token function">rm</span> -rf example/.gitignore example/.git</code></pre><p>Now add the following to your root project's <code>.gitignore</code> file to exclude the <code>build</code> and <code>node_modules</code> folder from git.</p><pre class="language-bash"><code class="language-bash">/example/node_modules<br>/example/build</code></pre><p>To use our library in the example project, just add the following to your <code>package.json</code> dependencies, and run <code>yarn</code> <strong>in the example directory.</strong></p><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span><br>  ...<br>  dependencies<span class="token operator">:</span> <span class="token punctuation">{</span><br>    ...<br>    <span class="token property">"typescript-react-test"</span><span class="token operator">:</span> <span class="token string">"link:.."</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre><p>This would install the package as a local dependency for our example project. If you're curious and want to know how it works and you're using VSCode, you can expand the <code>node_modules</code> folder in your example project, and you should be able to see the package with a ↪ symbol next to it.</p><picture><source type="image/webp" srcset="/img/vs-code-node-modules-316.webp 316w" sizes="(max-width: 600px) 480px, (max-width: 1024px) 768px, 1200px"><source type="image/jpeg" srcset="/img/vs-code-node-modules-316.jpeg 316w" sizes="(max-width: 600px) 480px, (max-width: 1024px) 768px, 1200px"><img src="../img/vs-code-node-modules-316.jpeg" width="316" height="189" alt="VSCode node_modules for our package" class="article-img" loading="lazy" decoding="async"></picture><p>You can now add your component to the <code>App.tsx</code> to try it out.</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> SayHello <span class="token keyword">from</span> <span class="token string">'typescript-react-test'</span><span class="token punctuation">;</span><br><span class="token keyword">import</span> <span class="token string">'./App.css'</span><span class="token punctuation">;</span><br><br><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>     </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SayHello</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Prateek<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span></code></pre><p>Run yarn start in <strong>the example folder</strong>, and you should be able to see your component in the browser. To update the lib</p><h2 class="relative"><a id="getting-ready-for-publishing" href="#getting-ready-for-publishing" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Getting ready for publishing</a></h2><p>So now that we have added the demo and tested our module locally its now time to publish it to NPM so others can use it as well.</p><p>Before we get to publishing, we need to tell NPM the files that need to be included when your package is installed as a dependency. There are two ways to do that -</p><ul><li>Create a <a href="http://npm.github.io/publishing-pkgs-docs/publishing/the-npmignore-file.html"><code>.npmignore</code></a> file, which is similar to <code>.gitignore</code> in which you blacklist the files that you don't want your package to include.</li><li>Use the <a href="https://docs.npmjs.com/files/package.json#files"><code>files</code> key</a> in your <code>package.json</code> to whitelist the files you want to include in your final package.</li></ul><p>I actually prefer the latter because, as you add more types of files such as ESLint configs, environment files, you don't need to remember to keep adding them to <code>.npmignore</code> instead, you can specify the files to be included in your <code>package.json</code></p><p>Although you can use a combination of the files key and <code>.npmignore</code> for certain situations like if you have <code>__tests__</code> in your lib folder and you want to exclude the tests but include the <code>lib</code> folder, in that case, you can specify <code>/lib</code> in the files key of <code>package.json</code> and add <code>__test__</code> in <code>.npmignore</code> so that the tests are not included, but the rest of the stuff is.</p><p>Remember that files like <code>README</code>, <code>package.json</code>, and <code>LICENSE</code> are automatically included in your package and cannot be excluded.</p><p>For our case, we only want to add the <code>lib</code> folder to the <code>package.json</code> because that's where all our compiled JavaScript files are. Add the following to your <code>package.json</code> -</p><pre class="language-json"><code class="language-json"><span class="token property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token string">"/lib"</span><br> <span class="token punctuation">]</span></code></pre><p>Time to publish our library!</p><p>If this is the first time you are publishing a package you would need to create an account on <a href="https://www.npmjs.com/">https://www.npmjs.com/</a> and then you need to log in from the command line using <code>npm login</code>.</p><p>After that, just run <code>npm publish</code> in your root directory, and voila, you've successfully created and published a TypeScript React NPM package.</p><p>You can find the code of the library and the demo we created <a href="https://github.com/prateek3255/typescript-react-demo-library">on GitHub</a>.</p><h2>Next Steps</h2><p>There still many things that you can and should do that I couldn't cover in the above guide, like -</p><ul><li>You can deploy the demo to something like <a href="https://www.netlify.com/blog/2016/09/29/a-step-by-step-guide-deploying-on-netlify/">Netlify</a> or <a href="https://github.com/marketplace/actions/deploy-to-github-pages">GitHub Pages</a> and automate the process to deploy changes when you merge PRs automatically.</li><li>Add test cases using <a href="https://www.pluralsight.com/guides/how-to-test-react-components-in-typescript">Jest and React Testing Library</a>.</li><li>Setup <a href="https://www.orangejellyfish.com/blog/code-consistency-with-eslint-and-husky/">Husky pre-commit hook with ESLint</a> for enforcing linting in your code.</li></ul><a class="fixed bottom-12 bg-white text-accent-blue flex items-center justify-center rounded cursor-pointer z-10 invisible lg:visible top-indicator-container" aria-label="Scroll to top" href="#"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="top-indicator" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 217.9L383 345c9.4 9.4 24.6 9.4 33.9 0 9.4-9.4 9.3-24.6 0-34L273 167c-9.1-9.1-23.7-9.3-33.1-.7L95 310.9c-4.7 4.7-7 10.9-7 17s2.3 12.3 7 17c9.4 9.4 24.6 9.4 33.9 0l127.1-127z"></path></svg></a></article><hr class="my-4"><div class="text-md mb-3 flex justify-between flex-col md:flex-row"><div><a href="/blog/tags/typescript" onclick='trackTagClick("typescript")' class="text-indigo-700 mr-1">#TypeScript </a><a href="/blog/tags/react" onclick='trackTagClick("react")' class="text-indigo-700 mr-1">#React </a><a href="/blog/tags/tutorial" onclick='trackTagClick("tutorial")' class="text-indigo-700 mr-1">#Tutorial</a></div><div class="mt-2 md:mt-0"><span class="font-bold mr-2">Enjoyed this blog, share it on: </span><a href="https://twitter.com/intent/tweet?url=undefined/blog/react-library-with-typescript/&via=psuranas&text=How to build a React library using TypeScript" target="_blank" rel="noreferrer noopener" class="text-indigo-700 mr-1">Twitter </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=undefined/blog/react-library-with-typescript/" target="_blank" rel="noreferrer noopener" class="text-indigo-700">LinkedIn</a></div></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8 bg-blue-100"><div class="text-center"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript. Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time. You can also <a target="_blank" rel="noreferrer noopener" class="underline" href="/blog/feed.xml">subscribe via RSS</a>.</p><form x-on:submit="handleSubscribe" name="subscribe_card"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8"><div class="mb-4 md:mb-0 md:mr-8 md:flex-shrink-0"><img alt="Prateek Surana" height="20" width="20" class="h-20 w-20 rounded-full border-indigo-500 border-2" src="/img/prateek-author.jpg"></div><div class="md:text-left text-center"><h4 class="text-lg font-bold mb-2 md:mb-0">About Prateek Surana</h4><p class="text-base">Prateek is a Frontend Engineer and an iOS developer, currently building <a href="https://devfolio.co" class="text-indigo-700" target="_blank" rel="noreferrer noopener">Devfolio</a>. Apart from his unconditional love for JavaScript and React, he also enjoys watching Marvel movies and playing quirky games on his phone.</p></div></div><div x-cloak x-show.transition.duration.300ms="showSubscribePopup" class="fixed border-gray-100 border-2 p-6 shadow rounded bottom-7 right-7 w-72 ml-auto xl:block hidden bg-blue-100 z-20"><img src="/img/subscribe-banner-image.png" alt="Subscribe to newsletter" style="top:-130px; right:79px;" class="absolute h-32"><div class="flex w-full justify-between mb-2"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><img src="/img/cross-black.svg" x-on:click="hideSubscribePopup" alt="Close the banner" class="h-5 mt-1 cursor-pointer"></div><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript.</p><br><p class="text-base">Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time.</p><form x-on:submit="handleSubscribe" name="subscribe_popup"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><script>function newsletter(){return{showSubscribePopup:!1,isSubscribeLoading:!1,emailField:"",hideSubscribePopup(){trackEvent("closed_subscribe_popup","subscribe"),this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)},handleSubscribe(e){e.preventDefault(),trackEvent(`clicked_on_subscribe_from_${e.target.name}`,"subscribe",e.target.name),this.isSubscribeLoading=!0;fetch("http://localhost:3000/api/register",{method:"POST",body:JSON.stringify({email:this.emailField})}).then(e=>e.json()).then(e=>{this.isSubscribeLoading=!1,this.emailField="",e.success?(window.location.href="undefined/confirm",this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)):alert(e.message)}).catch(e=>{this.isSubscribeLoading=!1,alert("Something went wrong, please refresh the page and try again!")})},startTimer(){clearTimeout(window.currentTimer),localStorage.getItem("has-hidden-subscription-popup")||(window.currentTimer=setTimeout(()=>{this.showSubscribePopup=!0},15e3),window.onscroll=()=>{document.body.offsetHeight-(window.innerHeight+window.scrollY)<=550&&(this.showSubscribePopup=!1)})}}}</script><footer class="bottom-0 text-center w-full py-8 px-1 md:px-0"><small class="text-gray-500">Copyright © Prateek&#39;s Blog <span id="copyright"><script>document.getElementById("copyright").appendChild(document.createTextNode((new Date).getFullYear()))</script></span>. Made with <a href="https://www.11ty.dev/" target="_blank" rel="noreferrer noopener" class="underline">Eleventy,</a> <a href="https://tailwindcss.com/" target="_blank" rel="noreferrer noopener" class="underline">Tailwind CSS</a>, and ❤&nbsp; by <a href="https://prateeksurana.me/" target="_blank" rel="noreferrer noopener" class="underline">Prateek Surana</a> • <a href="https://github.com/prateek3255/blog/edit/master/./src/blog/react-library-with-typescript.md" class="underline" target="_blank" rel="noreferrer noopener">Edit this page on GitHub</a></small></footer><script>var textContent,str,wordCount,readingTimeInMinutes,readingTimeAsString,article=document.getElementsByTagName("article")[0],readTime=document.getElementsByClassName("read-time")[0];article&&readTime&&(wordCount=(str=(str=(str=(textContent=article.textContent).replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\\n /,"\\n")).split(" ").filter(e=>"\\n"!==e).length,readingTimeInMinutes=Math.floor(wordCount/228)+1,readTime.innerText=readingTimeAsString=readingTimeInMinutes+" min read")</script></body></html>