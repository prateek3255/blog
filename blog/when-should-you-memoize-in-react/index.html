<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>When should you memoize in React</title><meta name="description" content="Explore why premature optimization can be bad in React and when should you actually use the memoization methods provided by React"><link rel="canonical" href="undefined/blog/when-should-you-memoize-in-react/"><link rel="apple-touch-icon" sizes="152x152" href="undefined/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="undefined/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="undefined/favicons/favicon-16x16.png"><link rel="manifest" href="undefined/favicons/site.webmanifest"><link rel="mask-icon" href="undefined/favicons/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="twitter:title" content="When should you memoize in React"><meta property="twitter:description" content="Explore why premature optimization can be bad in React and when should you actually use the memoization methods provided by React"><meta name="twitter:image" content="undefined/img/when-should-you-memoize-in-react.png"><meta name="twitter:card" content="summary_large_image"><meta property="og:title" content="When should you memoize in React"><meta property="og:description" content="Explore why premature optimization can be bad in React and when should you actually use the memoization methods provided by React"><meta property="og:image" content="undefined/img/when-should-you-memoize-in-react.png"><meta property="og:url" content="undefined/blog/when-should-you-memoize-in-react/"><meta property="og:type" content="article"><link rel="stylesheet" type="text/css" href="undefined/css/style.css"><link rel="stylesheet" type="text/css" href="undefined/css/prism-tomorrow.css"><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/brands.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/solid.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/fontawesome.min.js"></script><script>function trackTagClick(t){trackEvent("tag_clicked","tags",t)}function trackEvent(t,c,a){console.log("Event",{name:t,category:c,label:a})}</script><script async src="https://unpkg.com/smoothscroll-polyfill/dist/smoothscroll.min.js"></script><script async src="https://unpkg.com/smoothscroll-anchor-polyfill"></script><script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer="defer"></script></head><body><div class="w-full"><nav class="flex items-center justify-center lg:justify-between flex-wrap p-6 lg:px-0 container mx-auto" x-data="navbarData()" @keydown.escape="isOpen = false"><div class="flex items-center"><a href="/" aria-label="logo"><img src="/img/prateek-bitmoji.png" alt="Logo" height="80" width="63.2" class="h-20"></a></div><button x-on:click="handleToggle" type="button" class="ml-auto block lg:hidden px-2 text-primary-500 hover:text-primary-500 focus:outline-none focus:text-primary-500" :class="{ 'transition transform-180': isOpen }" aria-label="Menu"><svg class="h-6 w-6 fill-current" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path x-show="isOpen" fill-rule="evenodd" clip-rule="evenodd" d="M18.278 16.864a1 1 0 0 1-1.414 1.414l-4.829-4.828-4.828 4.828a1 1 0 0 1-1.414-1.414l4.828-4.829-4.828-4.828a1 1 0 0 1 1.414-1.414l4.829 4.828 4.828-4.828a1 1 0 1 1 1.414 1.414l-4.828 4.829 4.828 4.828z"/><path x-show="!isOpen" fill-rule="evenodd" d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/></svg></button><div class="w-full flex-grow lg:flex lg:items-center lg:w-auto text-center transition-all duration-700 ease-in-out opacity-0 lg:opacity-100" :class="{ 'max-h-80 opacity-100': isOpen, 'max-h-0 opacity-0': !isOpen }" x-show.transition="true"><ul class="pt-6 lg:pt-0 list-reset lg:flex justify-end flex-1 items-center"><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/">About</a></li><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog">Blog</a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://twitter.com/psuranas"><i class="fab fa-twitter"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://github.com/prateek3255"><i class="fab fa-github"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://stackoverflow.com/users/8252081/prateek-surana"><i class="fab fa-stack-overflow"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog/feed.xml"><i class="fas fa-rss"></i></a></li></ul></div></nav></div><script>function navbarData(){return{isOpen:!1,handleToggle(){this.isOpen=!this.isOpen,void 0!==window.annotationGroup&&(window.annotationGroup.hide(),setTimeout(()=>{window.annotationGroup.show()},800))}}}</script><div x-data="newsletter()" x-init="startTimer()"><div class="container max-w-3xl mt-6 px-6"><div class="pb-5 mb-5 border-b border-gray-100"><h1 class="font-bold text-5xl">When should you memoize in React</h1><p class="text-center text-base leading-6 font-medium text-gray-500">Last updated on <time>21 Apr 2021</time> by Prateek Surana &nbsp; • &nbsp;<span class="read-time"> - min read</span></p></div><article class="prose lg:prose-xl my-4 relative"><p>If you have heard about or used the React memoization methods (useMemo, useCallback, and memo), you might often get tempted to use them in situations where you might not need them.</p><p>When I first learned about these methods, I also often ended up using them everywhere because what harm optimizing something could do, right?</p><p>Well, as you might have guessed by now, I was wrong because these hooks and methods exist for some specific use cases, and if they're used mindlessly everywhere, they can actually worsen your app's performance.</p><p>In this article, I'll try my best to explain -</p><ol><li><a href="#why-premature-optimization-is-bad">Why premature optimization is bad</a></li><li><a href="#how-can-you-optimize-your-code-without-memoizing">How can you optimize your code without memoizing</a></li><li><a href="#when-should-you-actually-memoize">When should you actually memoize</a></li></ol><h2 class="relative"><a id="why-premature-optimization-is-bad" href="#why-premature-optimization-is-bad" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Why premature optimization is bad</a></h2><p>You might have heard this famous quote by <a href="https://en.wikipedia.org/wiki/Donald_Knuth">Donald Knuth</a>, that &quot;Premature optimization is the root of all evil.&quot; Well, the quote might be old, but it still holds its value for software engineers like us trying to eagerly optimize without analyzing its benefits. So let's understand why it is bad to prematurely memoize in React -</p><h3 class="relative"><a id="usecallback" href="#usecallback" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> useCallback</a></h3><p>Let's start with an example. What do you think about, handleChange in the below code snippet?</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">MyForm</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>firstName<span class="token punctuation">,</span> setFirstName<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Omitted for brevity<br>     */</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br>  <br>  <span class="token keyword">const</span> handleChange <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">setFirstName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">onSubmit</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>firstName<span class="token punctuation">"</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>I used to think that <code>useCallback</code> improves performance by returning a memoized callback that only changes if one of the dependencies changes. In our case, since the dependency array is empty, it would get memoized and would be more efficient than the normal inline function, right?</p><p>But, it's not as simple as that, because <strong>every optimization comes with a cost associated with it</strong>. And in the above case, the optimization is not worth the cost it comes with. But why?</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> handleChange <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token function">setFirstName</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>In the above case, <code>useCallback()</code> is called every time our <code>MyForm</code> component re-renders. Even though it returns the same function object, still the inline function is created on every render, <code>useCallback</code> just skips it to have the same reference to the function. Not only that, but we also have the empty dependency array, which itself is doing some work by running through some logical expressions to check if the variables inside have changed, etc.</p><p>So this is not really an optimization since <strong>the optimization costs more than not having the optimization</strong>. Also, our code is a bit more difficult to read than it was before because of the function being wrapped in a useCallback.</p><p>And as far as inline functions go, this is what <a href="https://reactjs.org/docs/faq-functions.html#is-it-ok-to-use-arrow-functions-in-render-methods">the official documentation on the React website</a> says, and <a href="https://reacttraining.com/blog/react-inline-functions-and-performance/">they are not actually as bad as you think they are</a>.</p><h3 class="relative"><a id="usememo-different-yet-similar" href="#usememo-different-yet-similar" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> useMemo different yet similar</a></h3><p><code>useMemo</code> is also very similar to <code>useCallback</code>, with the only difference that it allows memoization to any value type. It does so by accepting a function that returns a value and is only recomputed when the items in the dependency list change. So again, if I didn't want to initialize something on every render, I could do this right?</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">MightiestHeroes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> heroes <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <br>    <span class="token punctuation">[</span><span class="token string">'Iron man'</span><span class="token punctuation">,</span> <span class="token string">'Thor'</span><span class="token punctuation">,</span> <span class="token string">'Hulk'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <br>  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>	<br>	<span class="token keyword">return</span> <span class="token punctuation">(</span><br>		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>			</span><span class="token punctuation">{</span><span class="token comment">/* Does something with heroes, Ommited for brevity */</span><span class="token punctuation">}</span><span class="token plain-text"><br>		</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><br>	<span class="token punctuation">)</span><br><br><span class="token punctuation">}</span></code></pre><p>Again the savings are so minimal that making the code more complex isn't worth it, and it's probably worse because of the same reasons, which we discussed in the previous section.</p><p>For a case like this you would be much better off by defining the array outside the component.</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> heroes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Iron man'</span><span class="token punctuation">,</span> <span class="token string">'Thor'</span><span class="token punctuation">,</span> <span class="token string">'Hulk'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">MightiestHeroes</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>	<span class="token comment">// Ommited for brevity </span><br>	<br><span class="token punctuation">}</span></code></pre><h3 class="relative"><a id="edge-cases-with-memo" href="#edge-cases-with-memo" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Edge cases with memo</a></h3><p>The same thing goes with <code>memo</code>, if we're not careful enough your memoized component might end up doing more work and hence being more inefficient than the normal counterpart</p><p>Take this sandbox for example, how many times do you think this memoized component will render when you are incrementing the count.</p><iframe src="https://codesandbox.io/embed/musing-brahmagupta-chx76?expanddevtools=1&fontsize=12&hidenavigation=1&module=%2Fsrc%2FApp.js&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="musing-brahmagupta-chx76" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>But shouldn't it render only once because it takes only one <code>children</code> prop which doesn't appear to be changing across renders?</p><p>Well <code>memo</code> does a shallow comparison of the previous props and the new props and re-renders only when the props have changed. So if you've been working with JavaScript for some time then you must be aware of <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Equality_comparisons_and_sameness#strict_equality_using">Referential Equality</a> -</p><pre class="language-jsx"><code class="language-jsx"><span class="token number">2</span> <span class="token operator">===</span> <span class="token number">2</span> <span class="token comment">// true</span><br><span class="token boolean">true</span> <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token comment">// true</span><br><span class="token string">'prateek'</span> <span class="token operator">===</span> <span class="token string">'prateek'</span> <span class="token comment">// true</span><br><br><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">===</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// false</span><br><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// false</span><br><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">===</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// false</span></code></pre><p>And since <code>typeof children === 'object</code>, the equality check in memo always returns false, so whenever the parent re-renders, it will cause our memoized component to re-render as well.</p><h2 class="relative"><a id="how-can-you-optimize-your-code-without-memoizing" href="#how-can-you-optimize-your-code-without-memoizing" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> How can you optimize your code without memoizing</a></h2><p>In most cases, check if you can split the parts that change from the parts that don't change, this will probably solve most of the problems without needing to use memoization. For example, in the previous React.memo example, if we separate the heavy lifting component from the counting logic, then we can prevent the unnecessary re-renders.</p><iframe src="https://codesandbox.io/embed/summer-bird-w6nvm?expanddevtools=1&fontsize=12&hidenavigation=1&module=%2Fsrc%2FApp.js&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="summer-bird-w6nvm" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>You can checkout Dan Abramov's article <a href="https://overreacted.io/before-you-memo/">Before you Memo</a> if you want to read more about it.</p><p>But in some cases, you would need to use the memoization hooks and functions, so let's look at when you should use these methods.</p><h2 class="relative"><a id="when-should-you-actually-memoize" href="#when-should-you-actually-memoize" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> When should you actually memoize</a></h2><h3 class="relative"><a id="usecallback-and-usememo" href="#usecallback-and-usememo" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> useCallback and useMemo</a></h3><p>The main purpose of <code>useCallback</code> is to maintain <strong>referential equality</strong> of a function when passing it to a memoized component or using it in a dependency array (since functions are not referentially equal, as discussed above). For <code>useMemo</code> apart from referential equality and like <code>memo</code>, it is also a way to <strong>avoid recomputing expensive calculations.</strong> Let's understand how they work with some examples -</p><h4 class="relative"><a id="referential-equality" href="#referential-equality" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Referential Equality</a></h4><p>First, let's see how these hooks help us maintain referential equality, take a look at the following example (keep in mind that this is a contrived example to explain the use case of these hooks, actual implementations will vary)</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">PokemonSearch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> weight<span class="token punctuation">,</span> power<span class="token punctuation">,</span> realtimeStats <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>searchquery<span class="token punctuation">,</span> setSearchQuery<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> filters <span class="token operator">=</span> <span class="token punctuation">{</span><br>    weight<span class="token punctuation">,</span><br>    power<span class="token punctuation">,</span><br>    searchquery<span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> result <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePokemonSearch</span><span class="token punctuation">(</span>filters<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">updateQuery</span> <span class="token operator">=</span> <span class="token parameter">newQuery</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Some other stuff related to<br>     * analytics, omitted for brevity<br>     */</span><br>    <span class="token function">setSearchQuery</span><span class="token punctuation">(</span>newQuery<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RealTimeStats</span></span> <span class="token attr-name">stats</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>realtimeStats<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MemoizedSearch</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>searchquery<span class="token punctuation">}</span></span> <span class="token attr-name">updateQuery</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updateQuery<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SearchResult</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span> <span class="token attr-name">isLoading</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isLoading<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">usePokemonSearch</span> <span class="token operator">=</span> <span class="token parameter">filters</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>result<span class="token punctuation">,</span> setResult<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Fetch the pokemons using filters<br>     * and update the loading and result state<br>     * accordingly, omitted for brevity<br>     */</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>filters<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> isLoading <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>In this example, we have a <code>PokemonSearch</code> component that uses the <code>usePokemonSearch</code> custom hook to fetch the pokemons for a given set of filters. Our component receives the weight and power filters from the parent component. It also receives a prop for real-time stats, which changes quite often, as the name suggests.</p><p>Our component itself handles the last filter, called <code>searchQuery</code>, via <code>useState</code>. We pass this filter to a memoized component called <code>MemoizedSearch</code> with a method to update it called <code>updateQuery</code>.</p><p>You might have noticed by now the first problem with our example, every time our <code>PokemonSearch</code> re-renders, a new reference of our <code>updateQuery</code> function would be created (which would not be equal to the previous reference because of how referential equality works in JavaScript), causing the <code>MemoizedSearch</code> component to re-render unnecessarily, even when the <code>searchQuery</code> is same.</p><p>This is where <code>useCallback</code> saves the day -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> updateQuery <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token parameter">newQuery</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Some other stuff related to<br>     * analytics, omitted for brevity<br>     */</span><br>    <span class="token function">setSearchQuery</span><span class="token punctuation">(</span>newQuery<span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>This would help us in maintaining the same reference of the <code>updateQuery</code> function which will avoid the unnecessary re-renders of our <code>MemoizedSearch</code> component causing it to re-render only when the <code>searchQuery</code> changes.</p><p>If you check the <code>usePokemonSearch</code> custom hook, it has a <code>useEffect</code> that relies on the <code>filters</code> prop to decide whether to fetch the details of the pokemons whenever it changes. I hope that you noticed the next problem with our example as well. Every time the <code>PokemonSearch</code> re-renders, let's suppose not due to the change in one of the filters, it creates a new reference to our <code>filters</code> object, which won't be referentially equal to the last one causing the <code>useEffect</code> to run with every render of <code>PokemonSearch</code> and hence making a lot of unnecessary API calls.</p><p>Let's fix this with <code>useMemo</code> -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> filters <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span><br>  weight<span class="token punctuation">,</span><br>  power<span class="token punctuation">,</span><br>  searchquery<span class="token punctuation">,</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>weight<span class="token punctuation">,</span> power<span class="token punctuation">,</span> searchQuery<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Now the filter object reference will only be updated when either of our filter changes, thus calling the <code>useEffect</code> only when one of our filters change.</p><p>So the final code with all the optimizations looks like this -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">PokemonSearch</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> weight<span class="token punctuation">,</span> power<span class="token punctuation">,</span> realtimeStats <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>searchquery<span class="token punctuation">,</span> setSearchQuery<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> filters <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span><br>    weight<span class="token punctuation">,</span><br>    power<span class="token punctuation">,</span><br>    searchquery<span class="token punctuation">,</span><br>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>weight<span class="token punctuation">,</span> power<span class="token punctuation">,</span> searchQuery<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token punctuation">{</span> isLoading<span class="token punctuation">,</span> result <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePokemonSearch</span><span class="token punctuation">(</span>filters<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> updateQuery <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token parameter">newQuery</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Some other stuff related to<br>     * analytics, omitted for brevity<br>     */</span><br>    <span class="token function">setSearchQuery</span><span class="token punctuation">(</span>newQuery<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RealTimeStats</span></span> <span class="token attr-name">stats</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>realtimeStats<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MemoizedSearch</span></span> <span class="token attr-name">query</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>searchquery<span class="token punctuation">}</span></span> <span class="token attr-name">updateQuery</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updateQuery<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SearchResult</span></span> <span class="token attr-name">data</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>result<span class="token punctuation">}</span></span> <span class="token attr-name">isLoading</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>isLoading<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">usePokemonSearch</span> <span class="token operator">=</span> <span class="token parameter">filters</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>isLoading<span class="token punctuation">,</span> setLoading<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>result<span class="token punctuation">,</span> setResult<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token comment">/**<br>     * Fetch the pokemons using filters<br>     * and update the loading and result state<br>     * accordingly, omitted for brevity<br>     */</span><br>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>filters<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> isLoading <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h4 class="relative"><a id="avoiding-recomputing-expensive-calculations" href="#avoiding-recomputing-expensive-calculations" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Avoiding recomputing expensive calculations</a></h4><p>Apart from referential equality, the <code>useMemo</code> hook, similar to the <code>memo</code> function, serves one more purpose of avoiding recomputing expensive calculations with every render if they are not required.</p><p>For instance, take the following example, if you try to update the name really fast, you will be able to see a certain lag because the 35th Fibonacci number (which is purposefully slow and blocks the main thread while computing) is getting calculated every time your component re-renders even though the position remains the same.</p><iframe src="https://codesandbox.io/embed/expensive-calculation-without-usememo-p393q?fontsize=12&hidenavigation=1&module=%2Fsrc%2FApp.js&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="expensive-calculation-without-usememo" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>Now let's try this with <code>useMemo</code>. Try updating the name really fast again and see the difference -</p><iframe src="https://codesandbox.io/embed/expensive-calculation-with-usememo-s8hmx?fontsize=12&hidenavigation=1&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="expensive-calculation-with-usememo" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>With <code>useMemo</code> we only re-calculate the Fibonacci number only when the position changes thus avoiding the unnecessary main thread work.</p><h3 class="relative"><a id="memo" href="#memo" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> memo</a></h3><p>If your component re-renders the same result given the same props, <code>React.memo</code> can give you a performance boost by skipping re-rendering if the props haven't changed.</p><p>Dmitri created a really nice illustration in his article <a href="https://dmitripavlutin.com/use-react-memo-wisely/">Use React.memo() Wisely</a> which you should use a general rule of thumb when you're thinking about memoizing a component.</p><picture><source type="image/webp" srcset="/img/when-to-use-react-memo-480.webp 480w, /img/when-to-use-react-memo-768.webp 768w" sizes="(max-width: 600px) 480px, (max-width: 1024px) 768px, 1200px"><source type="image/jpeg" srcset="/img/when-to-use-react-memo-480.jpeg 480w, /img/when-to-use-react-memo-768.jpeg 768w" sizes="(max-width: 600px) 480px, (max-width: 1024px) 768px, 1200px"><img src="../img/when-to-use-react-memo-768.jpeg" width="768" height="1125" alt="When should you use React.memo" class="article-img" loading="lazy" decoding="async"></picture><p>Enough with the concepts, let's try to understand this with an example on when <code>React.memo</code> can be handy. In the below sandbox, we have a <code>usePokemon</code> hook that returns some static and real-time data for a pokemon.</p><p>The static details include the name image and abilities of the Pokemon. In contrast, the real-time info includes details like the number of people who want this Pokemon and the number of people who own the Pokemon, which change quite often.</p><p>These details are rendered by three components <code>PokemonDetails</code> which renders the static details, and <code>Cravers</code> and <code>Owners</code>, which render the real-time info, respectively.</p><iframe src="https://codesandbox.io/embed/pokemon-memo-tdkel?fontsize=12&hidenavigation=1&module=%2Fsrc%2FApp.js&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="pokemon-memo" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>Now, if you check the console in the above sandbox, it doesn't look good because even though <code>PokemonDetails</code> consist of static data, it still re-renders every time any of our real-time values change, which is not very performant. So let's use the Checklist by Dmitri mentioned above to see if we should memoize it -</p><ul><li><p><strong>Is it a pure functional component, that given the same props renders the same output?</strong></p><p>Yes, our <code>PokemonDetails</code> component is functional and renders the same output with the same props ✅</p></li><li><p><strong>Does it re-render often?</strong></p><p>Yes, it re-renders often because of the realtime values provided by our custom hook ✅</p></li><li><p><strong>Does it re-render with the same props?</strong></p><p>Yes, the props it uses don't change at all across all its renders ✅</p></li><li><p><strong>Is it a medium to big size component?</strong></p><p>Since this is a very contrived example, it isn't really isn't in the sandbox, but for the sake of this example let's assume it is (Although even though isn't very expensive but given that it satisfies the above three conditions it still is a pretty good case for memoization) ✅</p></li></ul><p>Since, our component satisfies the above conditions, let's memoize it -</p><iframe src="https://codesandbox.io/embed/pokemon-memo-forked-1j97f?fontsize=12&hidenavigation=1&module=%2Fsrc%2FApp.js&theme=dark&view=split" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" loading="lazy" title="pokemon-memo (forked)" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>If you check the console in the above sandbox, you'll see that it gets re-rendered only once, optimizing our code quite a bit by saving us potentially expensive re-renders.</p><h2 class="relative"><a id="conclusion" href="#conclusion" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Conclusion</a></h2><p>If you've reached this far, I assume you get the point I am trying to make here. I'll repeat it <strong>every optimization you do comes with a cost associated with it</strong>, and the optimization is only worth it if the benefits outweigh the cost. In most cases, you might even not need to apply these methods if you can separate the parts that often change from the parts that don't change that much, as we discussed above.</p><p>I know it's a bit annoying, and maybe in the future, some really smart compiler could automatically take care of these things for you, but till then, we would have to be careful and <a href="https://reactjs.org/docs/profiler.html">analyze the benefits</a> while using these optimizations.</p><h2 class="relative"><a id="have-i-read-this-before" href="#have-i-read-this-before" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Have I read this before?</a></h2><p>You might have because some parts of it were inspired by <a href="https://kentcdodds.com/blog/usememo-and-usecallback">this excellent post</a> by Kent C. Dodds. I really enjoyed the post, and realized that these methods were still often misused and hence deserved more attention, so I decided to write about it with examples from some situations that I have faced.</p><a class="fixed bottom-12 bg-white text-accent-blue flex items-center justify-center rounded cursor-pointer z-10 invisible lg:visible top-indicator-container" aria-label="Scroll to top" href="#"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="top-indicator" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 217.9L383 345c9.4 9.4 24.6 9.4 33.9 0 9.4-9.4 9.3-24.6 0-34L273 167c-9.1-9.1-23.7-9.3-33.1-.7L95 310.9c-4.7 4.7-7 10.9-7 17s2.3 12.3 7 17c9.4 9.4 24.6 9.4 33.9 0l127.1-127z"></path></svg></a></article><hr class="my-4"><div class="text-md mb-3 flex justify-between flex-col md:flex-row"><div><a href="/blog/tags/react" onclick='trackTagClick("react")' class="text-indigo-700 mr-1">#React </a><a href="/blog/tags/best-practices" onclick='trackTagClick("best-practices")' class="text-indigo-700 mr-1">#Best-Practices</a></div><div class="mt-2 md:mt-0"><span class="font-bold mr-2">Enjoyed this blog, share it on: </span><a href="https://twitter.com/intent/tweet?url=undefined/blog/when-should-you-memoize-in-react/&via=psuranas&text=When should you memoize in React" target="_blank" rel="noreferrer noopener" class="text-indigo-700 mr-1">Twitter </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=undefined/blog/when-should-you-memoize-in-react/" target="_blank" rel="noreferrer noopener" class="text-indigo-700">LinkedIn</a></div></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8 bg-blue-100"><div class="text-center"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript. Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time. You can also <a target="_blank" rel="noreferrer noopener" class="underline" href="/blog/feed.xml">subscribe via RSS</a>.</p><form x-on:submit="handleSubscribe" name="subscribe_card"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8"><div class="mb-4 md:mb-0 md:mr-8 md:flex-shrink-0"><img alt="Prateek Surana" height="20" width="20" class="h-20 w-20 rounded-full border-indigo-500 border-2" src="/img/prateek-author.jpg"></div><div class="md:text-left text-center"><h4 class="text-lg font-bold mb-2 md:mb-0">About Prateek Surana</h4><p class="text-base">Prateek is a Frontend Engineer and an iOS developer, currently building <a href="https://devfolio.co" class="text-indigo-700" target="_blank" rel="noreferrer noopener">Devfolio</a>. Apart from his unconditional love for JavaScript and React, he also enjoys watching Marvel movies and playing quirky games on his phone.</p></div></div><div x-cloak x-show.transition.duration.300ms="showSubscribePopup" class="fixed border-gray-100 border-2 p-6 shadow rounded bottom-7 right-7 w-72 ml-auto xl:block hidden bg-blue-100 z-20"><img src="/img/subscribe-banner-image.png" alt="Subscribe to newsletter" style="top:-130px; right:79px;" class="absolute h-32"><div class="flex w-full justify-between mb-2"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><img src="/img/cross-black.svg" x-on:click="hideSubscribePopup" alt="Close the banner" class="h-5 mt-1 cursor-pointer"></div><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript.</p><br><p class="text-base">Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time.</p><form x-on:submit="handleSubscribe" name="subscribe_popup"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><script>function newsletter(){return{showSubscribePopup:!1,isSubscribeLoading:!1,emailField:"",hideSubscribePopup(){trackEvent("closed_subscribe_popup","subscribe"),this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)},handleSubscribe(e){e.preventDefault(),trackEvent(`clicked_on_subscribe_from_${e.target.name}`,"subscribe",e.target.name),this.isSubscribeLoading=!0;fetch("http://localhost:3000/api/register",{method:"POST",body:JSON.stringify({email:this.emailField})}).then(e=>e.json()).then(e=>{this.isSubscribeLoading=!1,this.emailField="",e.success?(window.location.href="undefined/confirm",this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)):alert(e.message)}).catch(e=>{this.isSubscribeLoading=!1,alert("Something went wrong, please refresh the page and try again!")})},startTimer(){clearTimeout(window.currentTimer),localStorage.getItem("has-hidden-subscription-popup")||(window.currentTimer=setTimeout(()=>{this.showSubscribePopup=!0},15e3),window.onscroll=()=>{document.body.offsetHeight-(window.innerHeight+window.scrollY)<=550&&(this.showSubscribePopup=!1)})}}}</script><footer class="bottom-0 text-center w-full py-8 px-1 md:px-0"><small class="text-gray-500">Copyright © Prateek&#39;s Blog <span id="copyright"><script>document.getElementById("copyright").appendChild(document.createTextNode((new Date).getFullYear()))</script></span>. Made with <a href="https://www.11ty.dev/" target="_blank" rel="noreferrer noopener" class="underline">Eleventy,</a> <a href="https://tailwindcss.com/" target="_blank" rel="noreferrer noopener" class="underline">Tailwind CSS</a>, and ❤&nbsp; by <a href="https://prateeksurana.me/" target="_blank" rel="noreferrer noopener" class="underline">Prateek Surana</a> • <a href="https://github.com/prateek3255/blog/edit/master/./src/blog/when-should-you-memoize-in-react.md" class="underline" target="_blank" rel="noreferrer noopener">Edit this page on GitHub</a></small></footer><script>var textContent,str,wordCount,readingTimeInMinutes,readingTimeAsString,article=document.getElementsByTagName("article")[0],readTime=document.getElementsByClassName("read-time")[0];article&&readTime&&(wordCount=(str=(str=(str=(textContent=article.textContent).replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\\n /,"\\n")).split(" ").filter(e=>"\\n"!==e).length,readingTimeInMinutes=Math.floor(wordCount/228)+1,readTime.innerText=readingTimeAsString=readingTimeInMinutes+" min read")</script></body></html>