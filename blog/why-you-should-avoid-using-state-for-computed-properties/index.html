<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Why you should avoid using state for computed properties</title><meta name="description" content="Understand why creating state variables for properties that can be computed is a bad idea, and how you can handle some edge cases when you need to derive your state from props."><link rel="canonical" href="undefined/blog/why-you-should-avoid-using-state-for-computed-properties/"><link rel="apple-touch-icon" sizes="152x152" href="undefined/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="undefined/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="undefined/favicons/favicon-16x16.png"><link rel="manifest" href="undefined/favicons/site.webmanifest"><link rel="mask-icon" href="undefined/favicons/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="twitter:title" content="Why you should avoid using state for computed properties"><meta property="twitter:description" content="Understand why creating state variables for properties that can be computed is a bad idea, and how you can handle some edge cases when you need to derive your state from props."><meta name="twitter:image" content="undefined/img/why-you-should-avoid-using-state-for-computed-properties.png"><meta name="twitter:card" content="summary_large_image"><meta property="og:title" content="Why you should avoid using state for computed properties"><meta property="og:description" content="Understand why creating state variables for properties that can be computed is a bad idea, and how you can handle some edge cases when you need to derive your state from props."><meta property="og:image" content="undefined/img/why-you-should-avoid-using-state-for-computed-properties.png"><meta property="og:url" content="undefined/blog/why-you-should-avoid-using-state-for-computed-properties/"><meta property="og:type" content="article"><link rel="stylesheet" type="text/css" href="undefined/css/style.css"><link rel="stylesheet" type="text/css" href="undefined/css/prism-tomorrow.css"><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/brands.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/solid.min.js"></script><script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/fontawesome.min.js"></script><script>function trackTagClick(t){trackEvent("tag_clicked","tags",t)}function trackEvent(t,c,a){console.log("Event",{name:t,category:c,label:a})}</script><script async src="https://unpkg.com/smoothscroll-polyfill/dist/smoothscroll.min.js"></script><script async src="https://unpkg.com/smoothscroll-anchor-polyfill"></script><script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.8.2/dist/alpine.min.js" defer="defer"></script></head><body><div class="w-full"><nav class="flex items-center justify-center lg:justify-between flex-wrap p-6 lg:px-0 container mx-auto" x-data="navbarData()" @keydown.escape="isOpen = false"><div class="flex items-center"><a href="/" aria-label="logo"><img src="/img/prateek-bitmoji.png" alt="Logo" height="80" width="63.2" class="h-20"></a></div><button x-on:click="handleToggle" type="button" class="ml-auto block lg:hidden px-2 text-primary-500 hover:text-primary-500 focus:outline-none focus:text-primary-500" :class="{ 'transition transform-180': isOpen }" aria-label="Menu"><svg class="h-6 w-6 fill-current" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path x-show="isOpen" fill-rule="evenodd" clip-rule="evenodd" d="M18.278 16.864a1 1 0 0 1-1.414 1.414l-4.829-4.828-4.828 4.828a1 1 0 0 1-1.414-1.414l4.828-4.829-4.828-4.828a1 1 0 0 1 1.414-1.414l4.829 4.828 4.828-4.828a1 1 0 1 1 1.414 1.414l-4.828 4.829 4.828 4.828z"/><path x-show="!isOpen" fill-rule="evenodd" d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/></svg></button><div class="w-full flex-grow lg:flex lg:items-center lg:w-auto text-center transition-all duration-700 ease-in-out opacity-0 lg:opacity-100" :class="{ 'max-h-80 opacity-100': isOpen, 'max-h-0 opacity-0': !isOpen }" x-show.transition="true"><ul class="pt-6 lg:pt-0 list-reset lg:flex justify-end flex-1 items-center"><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/">About</a></li><li class="nav__item mr-1"><a @click="isOpen = false" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog">Blog</a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://twitter.com/psuranas"><i class="fab fa-twitter"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://github.com/prateek3255"><i class="fab fa-github"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="https://stackoverflow.com/users/8252081/prateek-surana"><i class="fab fa-stack-overflow"></i></a></li><li class="nav__item mr-1"><a @click="isOpen = false" target="_blank" rel="noreferrer noopener" class="text-ml inline-block text-gray-500 no-underline hover:text-indigo-500 py-2 px-4" href="/blog/feed.xml"><i class="fas fa-rss"></i></a></li></ul></div></nav></div><script>function navbarData(){return{isOpen:!1,handleToggle(){this.isOpen=!this.isOpen,void 0!==window.annotationGroup&&(window.annotationGroup.hide(),setTimeout(()=>{window.annotationGroup.show()},800))}}}</script><div x-data="newsletter()" x-init="startTimer()"><div class="container max-w-3xl mt-6 px-6"><div class="pb-5 mb-5 border-b border-gray-100"><h1 class="font-bold text-5xl">Why you should avoid using state for computed properties</h1><p class="text-center text-base leading-6 font-medium text-gray-500">Last updated on <time>18 Jul 2021</time> by Prateek Surana &nbsp; • &nbsp;<span class="read-time"> - min read</span></p></div><article class="prose lg:prose-xl my-4 relative"><p>I have often seen many people (including my past self) creating state variables for any kind of value that can change across renders including the ones that can be directly dervied from existing state or props. This pattern can often lead to some nasty and hard to debug state synchronization bugs, which can be easily avoided by computing those properties on the fly instead.</p><p>Let's try to understand with an example of what I meant in the above paragraph. Consider this example where we have a form with a field for name, and a submit button, which remains disabled until the user enters a name (A much better way to do this would be using <a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation">HTML form validation</a>, but don't forget this is a contrived example 😅). Right now, it has two state variables, one for keeping track of the name and the other for error (<a href="https://codesandbox.io/s/simple-name-state-9l8c5?file=/src/App.js">Try it out on codesandbox</a>) -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasError<span class="token punctuation">,</span> setHasError<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">handleNameChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> value <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span><br>    <span class="token function">setName</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">setHasError</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>App<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>form-item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span><span class="token plain-text">Name:</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleNameChange<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">disabled</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>hasError<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Submit</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p>Now, this might seem fine at first but imagine if a new requirement comes in, and you need to add a new field to the form, which is also required, so you would now need to update the <code>hasError</code> value there as well to keep the value in sync.</p><p>To exemplify the above problem, let's extend our above example by adding a field for age, and let's imagine the age needs to be greater than 18 years. (<a href="https://codesandbox.io/s/simple-name-with-gender-state-7wroc?file=/src/App.js">Try it out on codesandbox)</a></p><pre class="language-js"><code class="language-js"><span class="highlight-line"><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">const</span> <span class="token punctuation">[</span>age<span class="token punctuation">,</span> setAge<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>hasError<span class="token punctuation">,</span> setHasError<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">const</span> <span class="token function-variable function">handleErrorUpdate</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> currentName<span class="token punctuation">,</span> currentAge <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">setHasError</span><span class="token punctuation">(</span>currentName<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span> </mark><br><mark class="highlight-line highlight-line-active">      <span class="token operator">||</span> currentAge <span class="token operator">&lt;</span> <span class="token number">18</span> </mark><br><mark class="highlight-line highlight-line-active">      <span class="token operator">||</span> currentAge <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">  <span class="token punctuation">}</span><span class="token punctuation">;</span></mark><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token function-variable function">handleNameChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">    <span class="token keyword">const</span> value <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token function">setName</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">    <span class="token function">handleErrorUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> currentName<span class="token operator">:</span> value<span class="token punctuation">,</span> currentAge<span class="token operator">:</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token punctuation">}</span><span class="token punctuation">;</span></span><br><span class="highlight-line"></span><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">const</span> <span class="token function-variable function">handleAgeChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token keyword">const</span> value <span class="token operator">=</span></mark><br><mark class="highlight-line highlight-line-active">      event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span> </mark><br><mark class="highlight-line highlight-line-active">      <span class="token operator">?</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> </mark><br><mark class="highlight-line highlight-line-active">      <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">setAge</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">handleErrorUpdate</span><span class="token punctuation">(</span><span class="token punctuation">{</span> currentName<span class="token operator">:</span> name<span class="token punctuation">,</span> currentAge<span class="token operator">:</span> value <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">  <span class="token punctuation">}</span><span class="token punctuation">;</span></mark><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"App"</span><span class="token operator">></span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"form-item"</span><span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>label<span class="token operator">></span>Name<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></span><br><span class="highlight-line">        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> value<span class="token operator">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleNameChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></span><br><span class="highlight-line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><mark class="highlight-line highlight-line-active">      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"form-item"</span><span class="token operator">></span></mark><br><mark class="highlight-line highlight-line-active">        <span class="token operator">&lt;</span>label<span class="token operator">></span>Age<span class="token operator">:</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></mark><br><mark class="highlight-line highlight-line-active">        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"number"</span> value<span class="token operator">=</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span>handleAgeChange<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></mark><br><mark class="highlight-line highlight-line-active">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></mark><br><span class="highlight-line">      <span class="token operator">&lt;</span>button disabled<span class="token operator">=</span><span class="token punctuation">{</span>hasError<span class="token punctuation">}</span><span class="token operator">></span>Submit<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span></span><br><span class="highlight-line">    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></span><br><span class="highlight-line">  <span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>For the sake of DRY, I have moved the error update logic to a separate function. If we go by this logic, then we would have to call the <code>handleErrorUpdate</code> method every time we add or update a required form field. If we miss updating the error state, it can cause the <code>hasError</code> state to go out of sync and result in hard to debug errors for complex applications.</p><p>Now instead of doing it like this, we can calculate the error in a <code>useEffect</code> and set the error state there like this (<a href="https://codesandbox.io/s/simple-name-with-gender-state-use-effect-5zu27?file=/src/App.js">Try it out on codesandbox</a>) -</p><pre class="language-jsx"><code class="language-jsx">React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token function">setHasError</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> age <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token operator">||</span> age <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> age<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>And yes, this does simplify the code by removing the unnecessary code for calling the error handler wherever the relevant state is supposed to be updated. Also, if you're using <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks">eslint-plugin-react-hooks</a> (which you should definitely use), it would warn you if you add some new variable to the <code>setHasError</code> logic and don't include it in the dependency array.</p><p>But what if there's something even better? As you can see, the <code>hasError</code> state is just being derived from the existing state that we already have in our component. So instead of maintaining a separate state for it, we can calculate it on the fly with every render like this -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">const</span> hasError <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> age <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token operator">||</span> age <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">;</span></code></pre><p>This way, we wouldn't need to worry about <code>hasError</code> getting out of sync by introducing a new dependency. Also, it is a lot easier to understand and saves us an additional render. (<a href="https://codesandbox.io/s/simple-name-with-gender-state-final-8znyv?file=/src/App.js">Try it out on codesandbox)</a></p><p>One thing you might argue about is performance. Since we calculate this computed state property on every render wouldn't it be less performant than calculating it only when one of the dependent variables changes as we did previously?</p><p>The answer is yes, it depends. It could be if it's some computationally expensive calculation and variable that the calculation relies on don't change that often with every render, but guess what the <a href="https://reactjs.org/docs/hooks-reference.html#usememo"><code>React.useMemo</code></a> hook is built exactly for these kinds of situations.</p><blockquote><p>Although for most cases like the example we are working on, using <code>React.useMemo</code> would be a case of premature optimization because the variables depend on all the variables that cause a re-render, and it's not that expensive. You can also check out my article on <a href="https://prateeksurana.me/blog/when-should-you-memoize-in-react/">when you should memoize</a> if you are interested in exploring this topic further.</p></blockquote><h2 class="relative"><a id="what-about-derived-state-from-props" href="#what-about-derived-state-from-props" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> What about derived state from props?</a></h2><p>For props as well, you can rely on the same pattern of directly deriving the desired values from props as we discussed in the previous section and avoid managing the state internally to steer clear of any state synchronization problems. So for our previous example, if the name and age values were provided via props from the parent component, our implementation for <code>hasError</code> would have remained the same.</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">function</span> <span class="token function">App</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> name<span class="token punctuation">,</span> age <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token operator">...</span><br>  <span class="token keyword">const</span> hasError <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> age <span class="token operator">&lt;</span> <span class="token number">18</span> <span class="token operator">||</span> age <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">;</span><br>  <span class="token operator">...</span><br><span class="token punctuation">}</span> </code></pre><p>Although there are some edge cases where you need the props just for initial values and then manage them via some state internally.</p><p>Let's try to understand when you might run into a situation like this, with <a href="https://github.com/facebook/react/issues/15523">an example from this issue on the React repo</a> asking the same question.</p><p>In this example, we have a list of items and every item has an edit button next to it, clicking on which opens an editor on the side where the user can edit the item properties and can save or cancel the updates. Currently, the item properties are passed as props to the editor component, which it then uses as initial values for its internal state, which handles the editor inputs.</p><iframe src="https://codesandbox.io/embed/dervied-state-from-props-problem-2r0js?fontsize=12&hidenavigation=1&theme=dark&view=preview" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" title="dervied-state-from-props-problem" loading="lazy" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>This is what the code for the Editable list looks like -</p><pre class="language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">StatefulEditor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>description<span class="token punctuation">,</span> setDescription<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><br>        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setName</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span><br>      <span class="token punctuation">/></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span><br>        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><br>        <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>description<span class="token punctuation">}</span></span><br>        <span class="token attr-name">onChange</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setDescription</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">}</span></span><br>      <span class="token punctuation">/></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><br>          <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span><br>            props<span class="token punctuation">.</span><span class="token function">onConfirm</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> description <span class="token punctuation">}</span><span class="token punctuation">)</span><br>          <span class="token punctuation">}</span></span><br>        <span class="token punctuation">></span></span><span class="token plain-text"><br>          Ok<br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>onCancel<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Cancel</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">const</span> <span class="token function-variable function">EditableList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> <span class="token punctuation">[</span>itemUnderEdit<span class="token punctuation">,</span> setItemUnderEdit<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">const</span> <span class="token function-variable function">closeEditor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setItemUnderEdit</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token keyword">const</span> <span class="token function-variable function">saveChangedItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">itemToSave</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    props<span class="token punctuation">.</span><span class="token function">handleItemUpdate</span><span class="token punctuation">(</span>itemToSave<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token function">closeEditor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><br>  <span class="token keyword">return</span> <span class="token punctuation">(</span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>editable-list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>        </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><br>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text"><br>            </span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token plain-text"><br>            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setItemUnderEdit</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Edit</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text"><br>          </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text"><br>      </span><span class="token punctuation">{</span>itemUnderEdit <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">StatefulEditor</span></span><br>          <span class="token attr-name">item</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>itemUnderEdit<span class="token punctuation">}</span></span><br>          <span class="token attr-name">onConfirm</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>saveChangedItem<span class="token punctuation">}</span></span><br>          <span class="token attr-name">onCancel</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>closeEditor<span class="token punctuation">}</span></span><br>        <span class="token punctuation">/></span></span><br>      <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text"><br>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">;</span><br><br><span class="token keyword">export</span> <span class="token keyword">default</span> EditableList<span class="token punctuation">;</span></code></pre><p>If you click on 'Ok' or 'Cancel' to close the editor after editing an item and then opening another item, this seems to be working fine. But try clicking on the edit button for any other item without closing the editor. You will notice the problem with this approach. The values in the editor remain the same even though the props have changed.</p><p>So why does this happen? It is because the state only gets initialized during the initial component mount, and even though the change in props cause a re-render, our <code>useState</code> cannot be re-initialized. This is one of the reasons why the <a href="https://reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#anti-pattern-erasing-state-when-props-change">React docs recommend avoiding this pattern</a>.</p><p>But for our case, we have to rely on this pattern, so what can we do to keep the state and props in sync for this case?</p><p>Well, as it turns out, there are a few ways of fixing it. One is that you can add a <code>key</code> prop with the value as the id of your item to the Editor component. This would cause React to <a href="https://stackoverflow.com/a/43892905/8252081">unmount the previous instance of the component and remount it</a> causing our state to be initialized again whenever the props, i.e. the key with item id, change.</p><pre class="language-jsx"><code class="language-jsx"><span class="highlight-line"><span class="token operator">...</span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">StatefulEditor</span></span><br><mark class="highlight-line highlight-line-active">          <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>id<span class="token punctuation">}</span></span></mark><br><span class="highlight-line">          <span class="token attr-name">item</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>itemUnderEdit<span class="token punctuation">}</span></span></span><br><span class="highlight-line">          <span class="token attr-name">onConfirm</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>saveChangedItem<span class="token punctuation">}</span></span></span><br><span class="highlight-line">          <span class="token attr-name">onCancel</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>closeEditor<span class="token punctuation">}</span></span></span><br>        <span class="token punctuation">/></span></span><br><span class="highlight-line"><span class="token operator">...</span></span></code></pre><p>This should suffice for most situations. If your component tree is expensive, then the above method can slightly affect performance because your component gets unmounted and remounted again. So what the <a href="https://reactjs.org/docs/hooks-faq.html#how-do-i-implement-getderivedstatefromprops">React docs recommend</a> is that you update the state during rendering, and React will re-run the component with updated state immediately after the current render. So in our case, this is what it would look like this -</p><pre class="language-jsx"><code class="language-jsx"><span class="highlight-line"><span class="token keyword">const</span> <span class="token function-variable function">StatefulEditor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>name<span class="token punctuation">,</span> setName<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><span class="highlight-line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>description<span class="token punctuation">,</span> setDescription<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span></span><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">const</span> <span class="token punctuation">[</span>id<span class="token punctuation">,</span> setId<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active"></mark><br><mark class="highlight-line highlight-line-active">  <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>id <span class="token operator">!==</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">setName</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">setId</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">    <span class="token function">setDescription</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>item<span class="token punctuation">.</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span></mark><br><mark class="highlight-line highlight-line-active">  <span class="token punctuation">}</span></mark><br><span class="highlight-line"></span><br><span class="highlight-line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span><br><span class="highlight-line">    <span class="token operator">...</span></span><br><span class="highlight-line">  <span class="token punctuation">)</span></span><br><span class="highlight-line"><span class="token punctuation">}</span></span></code></pre><p>Here is the sandbox with the above fix, and if you check again you'll see that the issue is gone now -</p><iframe src="https://codesandbox.io/embed/dervied-state-from-props-solution-bmpsy?fontsize=12&hidenavigation=1&theme=dark&view=preview" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" title="dervied-state-from-props-solution" loading="lazy" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>Since this is a contrived example, it doesn't look great. In a real-world scenario, you might want to use <a href="https://reactjs.org/docs/hooks-reference.html#usereducer"><code>useReducer</code></a> if you have too many individual states to manage like this.</p><h2 class="relative"><a id="conclusion" href="#conclusion" class="header-anchor"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute top-2 -left-7 opacity-0 icon" height="20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg> Conclusion</a></h2><p>So I hope this article helped you understand why creating state variables for computed properties is not a good idea and how you can compute them on the fly instead and optimize via <code>useMemo</code> if needed. We also saw how you could sync state with props in some edge cases where you don't have any other reasonable option. You can also check out <a href="https://kentcdodds.com/blog/dont-sync-state-derive-it">this article by Kent C. Dodd's</a>, which talks about the same topic, with some additional thoughts on how you can handle it in other libraries as well.</p><p>Also, let me know in the comments section below if I have missed something or if you have better alternative ideas for the examples I used in this article.</p><a class="fixed bottom-12 bg-white text-accent-blue flex items-center justify-center rounded cursor-pointer z-10 invisible lg:visible top-indicator-container" aria-label="Scroll to top" href="#"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="top-indicator" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 217.9L383 345c9.4 9.4 24.6 9.4 33.9 0 9.4-9.4 9.3-24.6 0-34L273 167c-9.1-9.1-23.7-9.3-33.1-.7L95 310.9c-4.7 4.7-7 10.9-7 17s2.3 12.3 7 17c9.4 9.4 24.6 9.4 33.9 0l127.1-127z"></path></svg></a></article><hr class="my-4"><div class="text-md mb-3 flex justify-between flex-col md:flex-row"><div><a href="/blog/tags/react" onclick='trackTagClick("react")' class="text-indigo-700 mr-1">#React </a><a href="/blog/tags/best-practices" onclick='trackTagClick("best-practices")' class="text-indigo-700 mr-1">#Best-Practices</a></div><div class="mt-2 md:mt-0"><span class="font-bold mr-2">Enjoyed this blog, share it on: </span><a href="https://twitter.com/intent/tweet?url=undefined/blog/why-you-should-avoid-using-state-for-computed-properties/&via=psuranas&text=Why you should avoid using state for computed properties" target="_blank" rel="noreferrer noopener" class="text-indigo-700 mr-1">Twitter </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=undefined/blog/why-you-should-avoid-using-state-for-computed-properties/" target="_blank" rel="noreferrer noopener" class="text-indigo-700">LinkedIn</a></div></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8 bg-blue-100"><div class="text-center"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript. Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time. You can also <a target="_blank" rel="noreferrer noopener" class="underline" href="/blog/feed.xml">subscribe via RSS</a>.</p><form x-on:submit="handleSubscribe" name="subscribe_card"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><div class="container max-w-3xl border-gray-100 border-2 p-8 shadow rounded flex flex-col items-center md:flex-row mb-6 mt-8"><div class="mb-4 md:mb-0 md:mr-8 md:flex-shrink-0"><img alt="Prateek Surana" height="20" width="20" class="h-20 w-20 rounded-full border-indigo-500 border-2" src="/img/prateek-author.jpg"></div><div class="md:text-left text-center"><h4 class="text-lg font-bold mb-2 md:mb-0">About Prateek Surana</h4><p class="text-base">Prateek is a Frontend Engineer and an iOS developer, currently building <a href="https://devfolio.co" class="text-indigo-700" target="_blank" rel="noreferrer noopener">Devfolio</a>. Apart from his unconditional love for JavaScript and React, he also enjoys watching Marvel movies and playing quirky games on his phone.</p></div></div><div x-cloak x-show.transition.duration.300ms="showSubscribePopup" class="fixed border-gray-100 border-2 p-6 shadow rounded bottom-7 right-7 w-72 ml-auto xl:block hidden bg-blue-100 z-20"><img src="/img/subscribe-banner-image.png" alt="Subscribe to newsletter" style="top:-130px; right:79px;" class="absolute h-32"><div class="flex w-full justify-between mb-2"><h4 class="text-lg font-bold mb-2">Want to get better at React, JavaScript, and TypeScript?</h4><img src="/img/cross-black.svg" x-on:click="hideSubscribePopup" alt="Close the banner" class="h-5 mt-1 cursor-pointer"></div><p class="text-base">I regularly publish posts like this one, containing best practices, tips, and tutorials on React, JavaScript, and TypeScript.</p><br><p class="text-base">Subscribe to my newsletter to get them straight to your inbox. No spam ever. Unsubscribe at any time.</p><form x-on:submit="handleSubscribe" name="subscribe_popup"><input name="email" x-model="emailField" required type="email" placeholder="john@doe.com" class="input-primary mt-6"> <button x-bind:disabled="isSubscribeLoading" class="btn-primary" type="submit">Count me in</button></form></div></div><script>function newsletter(){return{showSubscribePopup:!1,isSubscribeLoading:!1,emailField:"",hideSubscribePopup(){trackEvent("closed_subscribe_popup","subscribe"),this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)},handleSubscribe(e){e.preventDefault(),trackEvent(`clicked_on_subscribe_from_${e.target.name}`,"subscribe",e.target.name),this.isSubscribeLoading=!0;fetch("http://localhost:3000/api/register",{method:"POST",body:JSON.stringify({email:this.emailField})}).then(e=>e.json()).then(e=>{this.isSubscribeLoading=!1,this.emailField="",e.success?(window.location.href="undefined/confirm",this.showSubscribePopup=!1,localStorage.setItem("has-hidden-subscription-popup",!0)):alert(e.message)}).catch(e=>{this.isSubscribeLoading=!1,alert("Something went wrong, please refresh the page and try again!")})},startTimer(){clearTimeout(window.currentTimer),localStorage.getItem("has-hidden-subscription-popup")||(window.currentTimer=setTimeout(()=>{this.showSubscribePopup=!0},15e3),window.onscroll=()=>{document.body.offsetHeight-(window.innerHeight+window.scrollY)<=550&&(this.showSubscribePopup=!1)})}}}</script><footer class="bottom-0 text-center w-full py-8 px-1 md:px-0"><small class="text-gray-500">Copyright © Prateek&#39;s Blog <span id="copyright"><script>document.getElementById("copyright").appendChild(document.createTextNode((new Date).getFullYear()))</script></span>. Made with <a href="https://www.11ty.dev/" target="_blank" rel="noreferrer noopener" class="underline">Eleventy,</a> <a href="https://tailwindcss.com/" target="_blank" rel="noreferrer noopener" class="underline">Tailwind CSS</a>, and ❤&nbsp; by <a href="https://prateeksurana.me/" target="_blank" rel="noreferrer noopener" class="underline">Prateek Surana</a> • <a href="https://github.com/prateek3255/blog/edit/master/./src/blog/avoid-using-state-for-computed-properties.md" class="underline" target="_blank" rel="noreferrer noopener">Edit this page on GitHub</a></small></footer><script>var textContent,str,wordCount,readingTimeInMinutes,readingTimeAsString,article=document.getElementsByTagName("article")[0],readTime=document.getElementsByClassName("read-time")[0];article&&readTime&&(wordCount=(str=(str=(str=(textContent=article.textContent).replace(/(^\s*)|(\s*$)/gi,"")).replace(/[ ]{2,}/gi," ")).replace(/\\n /,"\\n")).split(" ").filter(e=>"\\n"!==e).length,readingTimeInMinutes=Math.floor(wordCount/228)+1,readTime.innerText=readingTimeAsString=readingTimeInMinutes+" min read")</script></body></html>